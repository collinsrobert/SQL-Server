----THIS SCRIPT IS NOT READY 



USE [master]
GO
/****** Object:  Table [dbo].[vbnary]    Script Date: 10/18/2024 4:25:49 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[vbnary](
	[cmmand] [nvarchar](max) NULL
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
INSERT [dbo].[vbnary] ([cmmand]) VALUES (N'exec sp_executesql N''[msdb].[dbo].[sp_ssis_putpackage] @P1, @P2, @P3, @P4, @P5, @P6, @P7, @P8, @P9, @P10, @P11, @P12, @P13'',N''@P1 nvarchar(4000),@P2 uniqueidentifier,@P3 nvarchar(4000),@P4 datetime2(7),@P5 uniqueidentifier,@P6 varbinary(max),@P7 int,@P8 int,@P9 int,@P10 int,@P11 int,@P12 nvarchar(4000),@P13 uniqueidentifier'',N''Database MaintenancePlan Index n Stats'',''9F91F2FC-5771-45FD-AFCD-36A7BCAD4A9A'',NULL,''2024-10-18 14:01:48'',''08AA12D5-8F98-4DAB-A4FC-980B150A5DC8'',

0x3C3F786D6C2076657273696F6E3D22312E30223F3E3C4454533A45786563757461626C6520786D6C6E733A4454533D227777772E6D6963726F736F66742E636F6D2F53716C5365727665722F44747322204454533A72656649643D225061636B61676522204454533A4372656174696F6E446174653D2231302F31382F3230323420323A30313A343820504D22204454533A4372656174696F6E4E616D653D224D6963726F736F66742E5061636B61676522204454533A43726561746F72436F6D70757465724E616D653D225350564F424D53514C373022204454533A43726561746F724E616D653D22414450524F445C726F62657274635F61646D696E22204454533A44545349443D227B39463931463246432D353737312D343546442D414643442D3336413742434144344139417D22204454533A45786563757461626C65547970653D224D6963726F736F66742E5061636B61676522204454533A4C6173744D6F64696669656450726F6475637456657273696F6E3D2231362E302E353339352E3022204454533A4C6F63616C6549443D223130333322204454533A4F626A6563744E616D653D224461746162617365204D61696E74656E616E6365506C616E20496E646578206E20537461747322204454533A5061636B616765547970653D223622204454533A50726F74656374696F6E4C6576656C3D223522204454533A56657273696F6E475549443D227B35303437454146452D304431302D343030382D383442322D4335384339304538324439367D223E0D0A20203C4454533A50726F7065727479204454533A4E616D653D225061636B616765466F726D617456657273696F6E223E383C2F4454533A50726F70657274793E0D0A20203C4454533A436F6E6E656374696F6E4D616E61676572733E0D0A202020203C4454533A436F6E6E656374696F6E4D616E61676572204454533A72656649643D225061636B6167652E436F6E6E656374696F6E4D616E61676572735B4C6F63616C2073657276657220636F6E6E656374696F6E5D22204454533A4372656174696F6E4E616D653D2241444F2E4E45543A53514C22204454533A44545349443D227B42353732373544372D424530362D344146432D394137432D3935363538363244464436447D22204454533A4F626A6563744E616D653D224C6F63616C2073657276657220636F6E6E656374696F6E223E0D0A2020202020203C4454533A4F626A656374446174613E0D0A20202020202020203C4454533A436F6E6E656374696F6E4D616E61676572204454533A436F6E6E656374696F6E537472696E673D224461746120536F757263653D7364762D73727335323B496E74656772617465642053656375726974793D547275653B506F6F6C696E673D46616C73653B4D756C7469706C65416374697665526573756C74536574733D46616C73653B456E63727970743D46616C73653B547275737453657276657243657274696669636174653D46616C73653B222F3E0D0A2020202020203C2F4454533A4F626A656374446174613E0D0A202020203C2F4454533A436F6E6E656374696F6E4D616E616765723E0D0A20203C2F4454533A436F6E6E656374696F6E4D616E61676572733E0D0A20203C4454533A5661726961626C65733E0D0A202020203C4454533A5661726961626C65204454533A4372656174696F6E4E616D653D2222204454533A44545349443D227B33313545453845352D323433382D344534442D423435462D4239354238374631313837447D22204454533A496E636C756465496E446562756744756D703D223233343522204454533A4E616D6573706163653D22676C6F62616C22204454533A4F626A6563744E616D653D22456D61696C5265706F7274546F4F70657261746F72223E0D0A2020202020203C4454533A5661726961626C6556616C7565204454533A44617461547970653D22382220786D6C3A73706163653D227072657365727665223E3C2F4454533A5661726961626C6556616C75653E0D0A202020203C2F4454533A5661726961626C653E0D0A202020203C4454533A5661726961626C65204454533A4372656174696F6E4E616D653D2222204454533A44545349443D227B43314446344334342D463634312D343636322D383641312D3043433330423231393937427D22204454533A496E636C756465496E446562756744756D703D223637383922204454533A4E616D6573706163653D22676C6F62616C22204454533A4F626A6563744E616D653D22457874656E6465644C6F6767696E67223E0D0A2020202020203C4454533A5661726961626C6556616C7565204454533A44617461547970653D223131223E2D313C2F4454533A5661726961626C6556616C75653E0D0A202020203C2F4454533A5661726961626C653E0D0A202020203C4454533A5661726961626C65204454533A4372656174696F6E4E616D653D2222204454533A44545349443D227B41353835423632372D323231322D343638422D414244352D3939373343343438393439317D22204454533A496E636C756465496E446562756744756D703D223637383922204454533A4E616D6573706163653D22676C6F62616C22204454533A4F626A6563744E616D653D2247656E6572617465456D61696C5265706F7274223E0D0A2020202020203C4454533A5661726961626C6556616C7565204454533A44617461547970653D223131223E303C2F4454533A5661726961626C6556616C75653E0D0A202020203C2F4454533A5661726961626C653E0D0A202020203C4454533A5661726961626C65204454533A4372656174696F6E4E616D653D2222204454533A44545349443D227B39394330343843312D413234392D343538462D423131422D4241394534464634353437427D22204454533A496E636C756465496E446562756744756D703D223637383922204454533A4E616D6573706163653D22676C6F62616C22204454533A4F626A6563744E616D653D2247656E6572617465546578745265706F7274223E0D0A2020202020203C4454533A5661726961626C6556616C7565204454533A44617461547970653D223131223E2D313C2F4454533A5661726961626C6556616C75653E0D0A202020203C2F4454533A5661726961626C653E0D0A202020203C4454533A5661726961626C65204454533A4372656174696F6E4E616D653D2222204454533A44545349443D227B45393943323045442D383035322D343443442D423841342D3242443444423239373543337D22204454533A496E636C756465496E446562756744756D703D223233343522204454533A4E616D6573706163653D22676C6F62616C22204454533A4F626A6563744E616D653D224C6F63616C436F6E6E656374696F6E466F725265706F7274696E67416E644C6F6767696E67223E0D0A2020202020203C4454533A5661726961626C6556616C7565204454533A44617461547970653D2238223E4C6F63616C2073657276657220636F6E6E656374696F6E3C2F4454533A5661726961626C6556616C75653E0D0A202020203C2F4454533A5661726961626C653E0D0A202020203C4454533A5661726961626C65204454533A4372656174696F6E4E616D653D2222204454533A44545349443D227B31363142314232352D384642352D343139412D424244302D3834453236304139314333397D22204454533A496E636C756465496E446562756744756D703D223637383922204454533A4E616D6573706163653D22676C6F62616C22204454533A4F626A6563744E616D653D224C6F6752656D6F7465223E0D0A2020202020203C4454533A5661726961626C6556616C7565204454533A44617461547970653D223131223E303C2F4454533A5661726961626C6556616C75653E0D0A202020203C2F4454533A5661726961626C653E0D0A202020203C4454533A5661726961626C65204454533A4372656174696F6E4E616D653D2222204454533A44545349443D227B34434545333835412D443845442D343330302D423445422D4436453039413346394635447D22204454533A496E636C756465496E446562756744756D703D223233343522204454533A4E616D6573706163653D22676C6F62616C22204454533A4F626A6563744E616D653D224D61696E74656E616E636544657369676E657256657273696F6E223E0D0A2020202020203C4454533A5661726961626C6556616C7565204454533A44617461547970653D2238223E31362E302E353339352E303C2F4454533A5661726961626C6556616C75653E0D0A202020203C2F4454533A5661726961626C653E0D0A202020203C4454533A5661726961626C65204454533A4372656174696F6E4E616D653D2222204454533A44545349443D227B38384238394436412D453843432D343632412D393430382D4644374334353342324142307D22204454533A496E636C756465496E446562756744756D703D223233343522204454533A4E616D6573706163653D22676C6F62616C22204454533A4F626A6563744E616D653D2252656D6F7465436F6E6E656374696F6E4E616D65223E0D0A2020202020203C4454533A5661726961626C6556616C7565204454533A44617461547970653D22382220786D6C3A73706163653D227072657365727665223E3C2F4454533A5661726961626C6556616C75653E0D0A202020203C2F4454533A5661726961626C653E0D0A202020203C4454533A5661726961626C65204454533A4372656174696F6E4E616D653D2222204454533A44545349443D227B42393136324645372D444239382D344544382D393330432D3044344343424631383938437D22204454533A496E636C756465496E446562756744756D703D223233343522204454533A4E616D6573706163653D22676C6F62616C22204454533A4F626A6563744E616D653D2252756E4964223E0D0A2020202020203C4454533A5661726961626C6556616C7565204454533A44617461547970653D22382220786D6C3A73706163653D227072657365727665223E3C2F4454533A5661726961626C6556616C75653E0D0A202020203C2F4454533A5661726961626C653E0D0A202020203C4454533A5661726961626C65204454533A4372656174696F6E4E616D653D2222204454533A44545349443D227B32393443464242322D413834422D343343392D394541462D3530333343453035384546307D22204454533A496E636C756465496E446562756744756D703D223637383922204454533A4E616D6573706163653D22676C6F62616C22204454533A4F626A6563744E616D653D22546578745265706F7274496E4E657746696C65223E0D0A2020202020203C4454533A5661726961626C6556616C7565204454533A44617461547970653D223131223E2D313C2F4454533A5661726961626C6556616C75653E0D0A202020203C2F4454533A5661726961626C653E0D0A202020203C4454533A5661726961626C65204454533A4372656174696F6E4E616D653D2222204454533A44545349443D227B34423543443932392D454441442D343035352D413833432D3431354634383646313345347D22204454533A496E636C756465496E446562756744756D703D223233343522204454533A4E616D6573706163653D22676C6F62616C22204454533A4F626A6563744E616D653D22546578745265706F727450617468223E0D0A2020202020203C4454533A5661726961626C6556616C7565204454533A44617461547970653D2238223E463A5C4D5353514C31332E4D5353514C5345525645525C4D5353514C5C4C6F673C2F4454533A5661726961626C6556616C75653E0D0A202020203C2F4454533A5661726961626C653E0D0A20203C2F4454533A5661726961626C65733E0D0A20203C4454533A45786563757461626C65733E0D0A202020203C4454533A45786563757461626C65204454533A72656649643D225061636B6167655C5265706F7274696E67205461736B20666F7220737562706C616E2D7B36334445394134322D424344332D344335332D394233432D3039303241423341324333345C7D22204454533A4372656174696F6E4E616D653D224D6963726F736F66742E5265706F7274696E675461736B22204454533A44545349443D227B37423639333538392D383046422D344346452D414438382D4437323939423734314643457D22204454533A45786563757461626C65547970653D224D6963726F736F66742E5265706F7274696E675461736B22204454533A4C6F63616C6549443D222D3122204454533A4F626A6563744E616D653D225265706F7274696E67205461736B20666F7220737562706C616E2D7B36334445394134322D424344332D344335332D394233432D3039303241423341324333347D22204454533A5461736B436F6E746163743D224D61696E74656E616E636520506C616E205265706F7274696E67205461736B3B204D6963726F736F667420436F72706F726174696F6E3B204D6963726F736F66742053514C205365727665722076393B20EFBFBD2032303034204D6963726F736F667420436F72706F726174696F6E3B20416C6C205269676874732052657365727665643B687474703A2F2F7777772E6D6963726F736F66742E636F6D2F73716C2F737570706F72742F64656661756C742E6173703B3122204454533A54687265616448696E743D2230223E0D0A2020202020203C4454533A5661726961626C65732F3E0D0A2020202020203C4454533A4F626A656374446174613E0D0A20202020202020203C53514C5461736B3A53716C5461736B446174612053514C5461736B3A436F6E6E656374696F6E3D227B42353732373544372D424530362D344146432D394137432D3935363538363244464436447D222053514C5461736B3A53657276657256657273696F6E3D2239222053514C5461736B3A457874656E6465644C6F6767696E673D2254727565222053514C5461736B3A4C6F63616C436F6E6E656374696F6E466F724C6F6767696E673D224C6F63616C2073657276657220636F6E6E656374696F6E222053514C5461736B3A5461736B4E616D653D22222053514C5461736B3A49676E6F7265446174616261736573496E4E6F744F6E6C696E6553746174653D2246616C7365222053514C5461736B3A47656E6572617465546578745265706F72743D2254727565222053514C5461736B3A50726F78794163636F756E743D22222053514C5461736B3A4372656174654E657746696C653D2254727565222053514C5461736B3A506174683D22463A5C4D5353514C31332E4D5353514C5345525645525C4D5353514C5C4C6F67222053514C5461736B3A456D61696C5265706F72743D2246616C7365222053514C5461736B3A4C6F6752656D6F74653D2246616C73652220786D6C6E733A53514C5461736B3D227777772E6D6963726F736F66742E636F6D2F73716C7365727665722F6474732F7461736B732F73716C7461736B222F3E0D0A2020202020203C2F4454533A4F626A656374446174613E0D0A202020203C2F4454533A45786563757461626C653E0D0A202020203C4454533A45786563757461626C65204454533A72656649643D225061636B6167655C537562706C616E5F3122204454533A4372656174696F6E4E616D653D2253544F434B3A53455155454E434522204454533A44697361626C65643D225472756522204454533A44545349443D227B36334445394134322D424344332D344335332D394233432D3039303241423341324333347D22204454533A45786563757461626C65547970653D2253544F434B3A53455155454E434522204454533A4661696C506172656E744F6E4661696C7572653D225472756522204454533A4C6F63616C6549443D222D3122204454533A4F626A6563744E616D653D22537562706C616E5F31223E0D0A2020202020203C4454533A5661726961626C65733E0D0A20202020202020203C4454533A5661726961626C65204454533A4372656174696F6E4E616D653D2222204454533A44545349443D227B46393141464230312D414638392D343545462D393132442D4146303144444445464435307D22204454533A496E636C756465496E446562756744756D703D223637383922204454533A4E616D6573706163653D22737562706C616E7322204454533A4F626A6563744E616D653D22537562706C616E536F7274496E64657822204454533A526561644F6E6C793D2254727565223E0D0A202020202020202020203C4454533A5661726961626C6556616C7565204454533A44617461547970653D2233223E313C2F4454533A5661726961626C6556616C75653E0D0A20202020202020203C2F4454533A5661726961626C653E0D0A2020202020203C2F4454533A5661726961626C65733E0D0A2020202020203C4454533A45786563757461626C65733E0D0A20202020202020203C4454533A45786563757461626C65204454533A72656649643D225061636B6167655C537562706C616E5F315C52656275696C6420496E64657822204454533A4372656174696F6E4E616D653D224D6963726F736F66742E44624D61696E74656E616E63655265696E6465785461736B22204454533A44545349443D227B31453037393141422D303341322D344241302D424142362D4338333731363932353345447D22204454533A45786563757461626C65547970653D224D6963726F736F66742E44624D61696E74656E616E63655265696E6465785461736B22204454533A4661696C506172656E744F6E4661696C7572653D225472756522204454533A4C6F63616C6549443D222D3122204454533A4F626A6563744E616D653D2252656275696C6420496E64657822204454533A5461736B436F6E746163743D2252656275696C6420496E646578205461736B3B204D6963726F736F667420436F72706F726174696F6E3B204D6963726F736F66742053514C205365727665722076393B20C2A92032303034204D6963726F736F667420436F72706F726174696F6E3B20416C6C205269676874732052657365727665643B687474703A2F2F7777772E6D6963726F736F66742E636F6D2F73716C2F737570706F72742F64656661756C742E6173703B3122204454533A54687265616448696E743D2230223E0D0A202020202020202020203C4454533A5661726961626C65732F3E0D0A202020202020202020203C4454533A4576656E7448616E646C6572733E0D0A2020202020202020202020203C4454533A4576656E7448616E646C6572204454533A72656649643D225061636B6167655C537562706C616E5F315C52656275696C6420496E6465782E4576656E7448616E646C6572735B4F6E506F7374457865637574655D22204454533A4372656174696F6E4E616D653D224F6E506F73744578656375746522204454533A44545349443D227B35374536374641312D444341412D344342422D393334362D3438394133414434433437367D22204454533A4576656E7449443D2236363933313835363422204454533A4576656E744E616D653D224F6E506F73744578656375746522204454533A4C6F63616C6549443D222D31223E0D0A20202020202020202020202020203C4454533A5661726961626C65733E0D0A202020202020202020202020202020203C4454533A5661726961626C65204454533A4372656174696F6E4E616D653D2222204454533A4465736372697074696F6E3D225468652070726F7061676174652070726F7065727479206F6620746865206576656E7422204454533A44545349443D227B34354536313342342D414345352D344234452D383034442D3641314441393644383741447D22204454533A496E636C756465496E446562756744756D703D223637383922204454533A4E616D6573706163653D2253797374656D22204454533A4F626A6563744E616D653D2250726F706167617465223E0D0A2020202020202020202020202020202020203C4454533A5661726961626C6556616C7565204454533A44617461547970653D223131223E303C2F4454533A5661726961626C6556616C75653E0D0A202020202020202020202020202020203C2F4454533A5661726961626C653E0D0A20202020202020202020202020203C2F4454533A5661726961626C65733E0D0A20202020202020202020202020203C4454533A45786563757461626C65732F3E0D0A2020202020202020202020203C2F4454533A4576656E7448616E646C65723E0D0A2020202020202020202020203C4454533A4576656E7448616E646C6572204454533A72656649643D225061636B6167655C537562706C616E5F315C52656275696C6420496E6465782E4576656E7448616E646C6572735B4F6E507265457865637574655D22204454533A4372656174696F6E4E616D653D224F6E5072654578656375746522204454533A44545349443D227B31393935363536342D313643452D343845372D414631392D4442463945334231433535377D22204454533A4576656E7449443D2236343031363734373222204454533A4576656E744E616D653D224F6E5072654578656375746522204454533A4C6F63616C6549443D222D31223E0D0A20202020202020202020202020203C4454533A5661726961626C65733E0D0A202020202020202020202020202020203C4454533A5661726961626C65204454533A4372656174696F6E4E616D653D2222204454533A4465736372697074696F6E3D225468652070726F7061676174652070726F7065727479206F6620746865206576656E7422204454533A44545349443D227B35453943334635362D464331362D343144372D384234462D3443443741373645354437467D22204454533A496E636C756465496E446562756744756D703D223637383922204454533A4E616D6573706163653D2253797374656D22204454533A4F626A6563744E616D653D2250726F706167617465223E0D0A2020202020202020202020202020202020203C4454533A5661726961626C6556616C7565204454533A44617461547970653D223131223E303C2F4454533A5661726961626C6556616C75653E0D0A202020202020202020202020202020203C2F4454533A5661726961626C653E0D0A20202020202020202020202020203C2F4454533A5661726961626C65733E0D0A20202020202020202020202020203C4454533A45786563757461626C65732F3E0D0A2020202020202020202020203C2F4454533A4576656E7448616E646C65723E0D0A202020202020202020203C2F4454533A4576656E7448616E646C6572733E0D0A202020202020202020203C4454533A4F626A656374446174613E0D0A2020202020202020202020203C53514C5461736B3A53716C5461736B446174612053514C5461736B3A436F6E6E656374696F6E3D227B42353732373544372D424530362D344146432D394137432D3935363538363244464436447D222053514C5461736B3A446174616261736553656C656374696F6E547970653D2231222053514C5461736B3A53657276657256657273696F6E3D223133222053514C5461736B3A457874656E6465644C6F6767696E673D2254727565222053514C5461736B3A4C6F63616C436F6E6E656374696F6E466F724C6F6767696E673D224C6F63616C2073657276657220636F6E6E656374696F6E222053514C5461736B3A5461736B4E616D653D2252656275696C6420496E646578222053514C5461736B3A49676E6F7265446174616261736573496E4E6F744F6E6C696E6553746174653D2254727565222053514C5461736B3A5573654F726967696E616C416D6F756E743D2254727565222053514C5461736B3A50657263656E746167653D223230222053514C5461736B3A536F72743D2254727565222053514C5461736B3A4B6565704F6E6C696E653D2246616C7365222053514C5461736B3A536B6970556E737570706F727465643D2246616C7365222053514C5461736B3A506164496E6465783D2254727565222053514C5461736B3A4D6178696D756D4465677265654F66506172616C6C656C69736D557365643D2246616C7365222053514C5461736B3A4C6F775072696F72697479557365643D2246616C7365222053514C5461736B3A436865636B467261676D656E746174696F6E50657263656E74557365643D2254727565222053514C5461736B3A436865636B50616765436F756E74557365643D2254727565222053514C5461736B3A467261676D656E746174696F6E4F703D2246617374222053514C5461736B3A467261676D656E746174696F6E50657263656E743D2233222053514C5461736B3A50616765436F756E743D2231303030222053514C5461736B3A436865636B4C6173745573616765496E44617973557365643D2246616C73652220786D6C6E733A53514C5461736B3D227777772E6D6963726F736F66742E636F6D2F73716C7365727665722F6474732F7461736B732F73716C7461736B223E0D0A20202020202020202020202020203C53514C5461736B3A53656C65637465644461746162617365732053514C5461736B3A44617461626173654E616D653D226D6173746572222F3E0D0A20202020202020202020202020203C53514C5461736B3A53656C65637465644461746162617365732053514C5461736B3A44617461626173654E616D653D226D6F64656C222F3E0D0A20202020202020202020202020203C53514C5461736B3A53656C65637465644461746162617365732053514C5461736B3A44617461626173654E616D653D226D736462222F3E0D0A20202020202020202020202020203C53514C5461736B3A53656C65637465644461746162617365732053514C5461736B3A44617461626173654E616D653D225265706F7274536572766572222F3E0D0A20202020202020202020202020203C53514C5461736B3A53656C65637465644461746162617365732053514C5461736B3A44617461626173654E616D653D225265706F727453657276657254656D704442222F3E0D0A20202020202020202020202020203C53514C5461736B3A53656C65637465644461746162617365732053514C5461736B3A44617461626173654E616D653D225265706F72745365727665725F45787465726E616C5253222F3E0D0A20202020202020202020202020203C53514C5461736B3A53656C65637465644461746162617365732053514C5461736B3A44617461626173654E616D653D225265706F72745365727665725F45787465726E616C525354656D704442222F3E0D0A20202020202020202020202020203C53514C5461736B3A53656C65637465644461746162617365732053514C5461736B3A44617461626173654E616D653D22535349534442222F3E0D0A20202020202020202020202020203C53514C5461736B3A53656C65637465644461746162617365732053514C5461736B3A44617461626173654E616D653D22646973747269627574696F6E222F3E0D0A2020202020202020202020203C2F53514C5461736B3A53716C5461736B446174613E0D0A202020202020202020203C2F4454533A4F626A656374446174613E0D0A20202020202020203C2F4454533A45786563757461626C653E0D0A20202020202020203C4454533A45786563757461626C65204454533A72656649643D225061636B6167655C537562706C616E5F315C557064617465205374617469737469637322204454533A4372656174696F6E4E616D653D224D6963726F736F66742E44624D61696E74656E616E6365557064617465537461746973746963735461736B22204454533A44545349443D227B36313534423137392D304442462D343833342D423444332D4433363141373645444136417D22204454533A45786563757461626C65547970653D224D6963726F736F66742E44624D61696E74656E616E6365557064617465537461746973746963735461736B22204454533A4661696C506172656E744F6E4661696C7572653D225472756522204454533A4C6F63616C6549443D222D3122204454533A4F626A6563744E616D653D22557064617465205374617469737469637322204454533A5461736B436F6E746163743D225570646174652053746174697374696373205461736B3B204D6963726F736F667420436F72706F726174696F6E3B204D6963726F736F66742053514C205365727665722076393B20C2A92032303034204D6963726F736F667420436F72706F726174696F6E3B20416C6C205269676874732052657365727665643B687474703A2F2F7777772E6D6963726F736F66742E636F6D2F73716C2F737570706F72742F64656661756C742E6173703B3122204454533A54687265616448696E743D2230223E0D0A202020202020202020203C4454533A5661726961626C65732F3E0D0A202020202020202020203C4454533A4576656E7448616E646C6572733E0D0A2020202020202020202020203C4454533A4576656E7448616E646C6572204454533A72656649643D225061636B6167655C537562706C616E5F315C55706461746520537461746973746963732E4576656E7448616E646C6572735B4F6E506F7374457865637574655D22204454533A4372656174696F6E4E616D653D224F6E506F73744578656375746522204454533A44545349443D227B33394542453835452D363137392D344233432D424541302D4546423543303735353930387D22204454533A4576656E7449443D223322204454533A4576656E744E616D653D224F6E506F73744578656375746522204454533A4C6F63616C6549443D222D31223E0D0A20202020202020202020202020203C4454533A5661726961626C65733E0D0A202020202020202020202020202020203C4454533A5661726961626C65204454533A4372656174696F6E4E616D653D2222204454533A4465736372697074696F6E3D225468652070726F7061676174652070726F7065727479206F6620746865206576656E7422204454533A44545349443D227B36434539364339452D383735322D343332352D394345372D3238363243434338303245437D22204454533A496E636C756465496E446562756744756D703D223637383922204454533A4E616D6573706163653D2253797374656D22204454533A4F626A6563744E616D653D2250726F706167617465223E0D0A2020202020202020202020202020202020203C4454533A5661726961626C6556616C7565204454533A44617461547970653D223131223E303C2F4454533A5661726961626C6556616C75653E0D0A202020202020202020202020202020203C2F4454533A5661726961626C653E0D0A20202020202020202020202020203C2F4454533A5661726961626C65733E0D0A20202020202020202020202020203C4454533A45786563757461626C65732F3E0D0A2020202020202020202020203C2F4454533A4576656E7448616E646C65723E0D0A2020202020202020202020203C4454533A4576656E7448616E646C6572204454533A72656649643D225061636B6167655C537562706C616E5F315C55706461746520537461746973746963732E4576656E7448616E646C6572735B4F6E507265457865637574655D22204454533A4372656174696F6E4E616D653D224F6E5072654578656375746522204454533A44545349443D227B34393943434642322D334345412D343143312D423237432D3143453733463742313839437D22204454533A4576656E7449443D223138373939303931303822204454533A4576656E744E616D653D224F6E5072654578656375746522204454533A4C6F63616C6549443D222D31223E0D0A20202020202020202020202020203C4454533A5661726961626C65733E0D0A202020202020202020202020202020203C4454533A5661726961626C65204454533A4372656174696F6E4E616D653D2222204454533A4465736372697074696F6E3D225468652070726F7061676174652070726F7065727479206F6620746865206576656E7422204454533A44545349443D227B33323032383630462D413935312D344145422D394130302D4644434437413938354542427D22204454533A496E636C756465496E446562756744756D703D223637383922204454533A4E616D6573706163653D2253797374656D22204454533A4F626A6563744E616D653D2250726F706167617465223E0D0A2020202020202020202020202020202020203C4454533A5661726961626C6556616C7565204454533A44617461547970653D223131223E303C2F4454533A5661726961626C6556616C75653E0D0A202020202020202020202020202020203C2F4454533A5661726961626C653E0D0A20202020202020202020202020203C2F4454533A5661726961626C65733E0D0A20202020202020202020202020203C4454533A45786563757461626C65732F3E0D0A2020202020202020202020203C2F4454533A4576656E7448616E646C65723E0D0A202020202020202020203C2F4454533A4576656E7448616E646C6572733E0D0A202020202020202020203C4454533A4F626A656374446174613E0D0A2020202020202020202020203C53514C5461736B3A53716C5461736B446174612053514C5461736B3A436F6E6E656374696F6E3D227B42353732373544372D424530362D344146432D394137432D3935363538363244464436447D222053514C5461736B3A446174616261736553656C656374696F6E547970653D2231222053514C5461736B3A53657276657256657273696F6E3D2239222053514C5461736B3A457874656E6465644C6F6767696E673D2254727565222053514C5461736B3A4C6F63616C436F6E6E656374696F6E466F724C6F6767696E673D224C6F63616C2073657276657220636F6E6E656374696F6E222053514C5461736B3A5461736B4E616D653D225570646174652053746174697374696373222053514C5461736B3A49676E6F7265446174616261736573496E4E6F744F6E6C696E6553746174653D2254727565222053514C5461736B3A55706461746553746174697374696373547970653D2231222053514C5461736B3A5570646174655363616E547970653D2233222053514C5461736B3A55706461746553616D706C6556616C75653D2235302220786D6C6E733A53514C5461736B3D227777772E6D6963726F736F66742E636F6D2F73716C7365727665722F6474732F7461736B732F73716C7461736B223E0D0A20202020202020202020202020203C53514C5461736B3A53656C65637465644461746162617365732053514C5461736B3A44617461626173654E616D653D226D6173746572222F3E0D0A20202020202020202020202020203C53514C5461736B3A53656C65637465644461746162617365732053514C5461736B3A44617461626173654E616D653D226D6F64656C222F3E0D0A20202020202020202020202020203C53514C5461736B3A53656C65637465644461746162617365732053514C5461736B3A44617461626173654E616D653D226D736462222F3E0D0A20202020202020202020202020203C53514C5461736B3A53656C65637465644461746162617365732053514C5461736B3A44617461626173654E616D653D225265706F7274536572766572222F3E0D0A20202020202020202020202020203C53514C5461736B3A53656C65637465644461746162617365732053514C5461736B3A44617461626173654E616D653D225265706F727453657276657254656D704442222F3E0D0A20202020202020202020202020203C53514C5461736B3A53656C65637465644461746162617365732053514C5461736B3A44617461626173654E616D653D225265706F72745365727665725F45787465726E616C5253222F3E0D0A20202020202020202020202020203C53514C5461736B3A53656C65637465644461746162617365732053514C5461736B3A44617461626173654E616D653D225265706F72745365727665725F45787465726E616C525354656D704442222F3E0D0A20202020202020202020202020203C53514C5461736B3A53656C65637465644461746162617365732053514C5461736B3A44617461626173654E616D653D22535349534442222F3E0D0A20202020202020202020202020203C53514C5461736B3A53656C65637465644461746162617365732053514C5461736B3A44617461626173654E616D653D22646973747269627574696F6E222F3E0D0A2020202020202020202020203C2F53514C5461736B3A53716C5461736B446174613E0D0A202020202020202020203C2F4454533A4F626A656374446174613E0D0A20202020202020203C2F4454533A45786563757461626C653E0D0A2020202020203C2F4454533A45786563757461626C65733E0D0A2020202020203C4454533A507265636564656E6365436F6E73747261696E74733E0D0A20202020202020203C4454533A507265636564656E6365436F6E73747261696E74204454533A72656649643D225061636B6167655C537562706C616E5F312E507265636564656E6365436F6E73747261696E74735B7B31453037393141422D303341322D344241302D424142362D4338333731363932353345445C7D5D22204454533A4372656174696F6E4E616D653D2222204454533A44545349443D227B32433744313136312D373139442D344542462D383739422D3838373246463445433446347D22204454533A46726F6D3D225061636B6167655C537562706C616E5F315C52656275696C6420496E64657822204454533A4C6F676963616C416E643D225472756522204454533A4F626A6563744E616D653D227B31453037393141422D303341322D344241302D424142362D4338333731363932353345447D22204454533A546F3D225061636B6167655C537562706C616E5F315C5570646174652053746174697374696373222F3E0D0A2020202020203C2F4454533A507265636564656E6365436F6E73747261696E74733E0D0A2020202020203C4454533A4576656E7448616E646C6572733E0D0A20202020202020203C4454533A4576656E7448616E646C6572204454533A72656649643D225061636B6167655C537562706C616E5F312E4576656E7448616E646C6572735B4F6E506F7374457865637574655D22204454533A4372656174696F6E4E616D653D224F6E506F73744578656375746522204454533A44545349443D227B43353244423233392D443636452D344236392D383030372D3545303834453436363039387D22204454533A4576656E7449443D2231303036363333313622204454533A4576656E744E616D653D224F6E506F73744578656375746522204454533A4C6F63616C6549443D222D31223E0D0A202020202020202020203C4454533A5661726961626C65733E0D0A2020202020202020202020203C4454533A5661726961626C65204454533A4372656174696F6E4E616D653D2222204454533A4465736372697074696F6E3D225468652070726F7061676174652070726F7065727479206F6620746865206576656E7422204454533A44545349443D227B36453032423434332D344246362D343935422D413539322D3938334234454339363945327D22204454533A496E636C756465496E446562756744756D703D223637383922204454533A4E616D6573706163653D2253797374656D22204454533A4F626A6563744E616D653D2250726F706167617465223E0D0A20202020202020202020202020203C4454533A5661726961626C6556616C7565204454533A44617461547970653D223131223E303C2F4454533A5661726961626C6556616C75653E0D0A2020202020202020202020203C2F4454533A5661726961626C653E0D0A202020202020202020203C2F4454533A5661726961626C65733E0D0A202020202020202020203C4454533A45786563757461626C65733E0D0A2020202020202020202020203C4454533A45786563757461626C65204454533A72656649643D225061636B6167655C537562706C616E5F312E4576656E7448616E646C6572735B4F6E506F7374457865637574655D5C7B32443141383934422D313232432D343137352D383846432D4238423032453439363341305C7D22204454533A4372656174696F6E4E616D653D224D6963726F736F66742E537562506C616E506F7374457865637574655461736B22204454533A44545349443D227B32443141383934422D313232432D343137352D383846432D4238423032453439363341307D22204454533A45786563757461626C65547970653D224D6963726F736F66742E537562506C616E506F7374457865637574655461736B22204454533A4C6F63616C6549443D222D3122204454533A4F626A6563744E616D653D227B32443141383934422D313232432D343137352D383846432D4238423032453439363341307D22204454533A5461736B436F6E746163743D224D61696E74656E616E636520506C616E205265706F7274696E67205461736B3B204D6963726F736F667420436F72706F726174696F6E3B204D6963726F736F66742053514C205365727665722076393B20C2A92032303034204D6963726F736F667420436F72706F726174696F6E3B20416C6C205269676874732052657365727665643B687474703A2F2F7777772E6D6963726F736F66742E636F6D2F73716C2F737570706F72742F64656661756C742E6173703B31223E0D0A20202020202020202020202020203C4454533A5661726961626C65732F3E0D0A20202020202020202020202020203C4454533A4F626A656374446174613E0D0A202020202020202020202020202020203C53514C5461736B3A53716C5461736B446174612053514C5461736B3A436F6E6E656374696F6E3D227B42353732373544372D424530362D344146432D394137432D3935363538363244464436447D222053514C5461736B3A53657276657256657273696F6E3D2239222053514C5461736B3A457874656E6465644C6F6767696E673D2254727565222053514C5461736B3A4C6F63616C436F6E6E656374696F6E466F724C6F6767696E673D22222053514C5461736B3A5461736B4E616D653D22222053514C5461736B3A49676E6F7265446174616261736573496E4E6F744F6E6C696E6553746174653D2246616C73652220786D6C6E733A53514C5461736B3D227777772E6D6963726F736F66742E636F6D2F73716C7365727665722F6474732F7461736B732F73716C7461736B222F3E0D0A20202020202020202020202020203C2F4454533A4F626A656374446174613E0D0A2020202020202020202020203C2F4454533A45786563757461626C653E0D0A202020202020202020203C2F4454533A45786563757461626C65733E0D0A20202020202020203C2F4454533A4576656E7448616E646C65723E0D0A20202020202020203C4454533A4576656E7448616E646C6572204454533A72656649643D225061636B6167655C537562706C616E5F312E4576656E7448616E646C6572735B4F6E507265457865637574655D22204454533A4372656174696F6E4E616D653D224F6E5072654578656375746522204454533A44545349443D227B41464434363437362D453435332D343044382D394234302D3143323132383233464342437D22204454533A4576656E7449443D2236363933313835363422204454533A4576656E744E616D653D224F6E5072654578656375746522204454533A4C6F63616C6549443D222D31223E0D0A202020202020202020203C4454533A5661726961626C65733E0D0A2020202020202020202020203C4454533A5661726961626C65204454533A4372656174696F6E4E616D653D2222204454533A4465736372697074696F6E3D225468652070726F7061676174652070726F7065727479206F6620746865206576656E7422204454533A44545349443D227B39363235393530452D394342452D343943322D393433422D4345334137444230313738447D22204454533A496E636C756465496E446562756744756D703D223637383922204454533A4E616D6573706163653D2253797374656D22204454533A4F626A6563744E616D653D2250726F706167617465223E0D0A20202020202020202020202020203C4454533A5661726961626C6556616C7565204454533A44617461547970653D223131223E303C2F4454533A5661726961626C6556616C75653E0D0A2020202020202020202020203C2F4454533A5661726961626C653E0D0A202020202020202020203C2F4454533A5661726961626C65733E0D0A202020202020202020203C4454533A45786563757461626C65733E0D0A2020202020202020202020203C4454533A45786563757461626C65204454533A72656649643D225061636B6167655C537562706C616E5F312E4576656E7448616E646C6572735B4F6E507265457865637574655D5C7B36443042363845312D413237372D343043392D423934332D4330374537323434444134375C7D22204454533A4372656174696F6E4E616D653D224D6963726F736F66742E4578656375746553514C5461736B22204454533A44545349443D227B36443042363845312D413237372D343043392D423934332D4330374537323434444134377D22204454533A45786563757461626C65547970653D224D6963726F736F66742E4578656375746553514C5461736B22204454533A4C6F63616C6549443D222D3122204454533A4F626A6563744E616D653D227B36443042363845312D413237372D343043392D423934332D4330374537323434444134377D22204454533A5461736B436F6E746163743D22457865637574652053514C205461736B3B204D6963726F736F667420436F72706F726174696F6E3B2053514C2053657276657220323032323B20C2A92032303232204D6963726F736F667420436F72706F726174696F6E3B20416C6C205269676874732052657365727665643B687474703A2F2F7777772E6D6963726F736F66742E636F6D2F73716C2F737570706F72742F64656661756C742E6173703B31223E0D0A20202020202020202020202020203C4454533A5661726961626C65732F3E0D0A20202020202020202020202020203C4454533A4F626A656374446174613E0D0A202020202020202020202020202020203C53514C5461736B3A53716C5461736B446174612053514C5461736B3A436F6E6E656374696F6E3D227B42353732373544372D424530362D344146432D394137432D3935363538363244464436447D222053514C5461736B3A53716C53746174656D656E74536F757263653D224445434C41524520404775696420554E495155454944454E54494649455220262378413B262378413B2045584543555445206D7364622E2E73705F6D61696E74706C616E5F6F70656E5F6C6F67656E74727920277B39463931463246432D353737312D343546442D414643442D3336413742434144344139417D272C20277B36334445394134322D424344332D344335332D394233432D3039303241423341324333347D272C4E554C4C2C204047756964204F555450555420262378413B262378413B2053656C65637420434F4E56455254286E76617263686172283338292C4047756964292041532052756E4964222053514C5461736B3A526573756C74547970653D22526573756C74536574547970655F53696E676C65526F772220786D6C6E733A53514C5461736B3D227777772E6D6963726F736F66742E636F6D2F73716C7365727665722F6474732F7461736B732F73716C7461736B223E0D0A2020202020202020202020202020202020203C53514C5461736B3A526573756C7442696E64696E672053514C5461736B3A526573756C744E616D653D2230222053514C5461736B3A4474735661726961626C654E616D653D2252756E4964222F3E0D0A202020202020202020202020202020203C2F53514C5461736B3A53716C5461736B446174613E0D0A20202020202020202020202020203C2F4454533A4F626A656374446174613E0D0A2020202020202020202020203C2F4454533A45786563757461626C653E0D0A202020202020202020203C2F4454533A45786563757461626C65733E0D0A20202020202020203C2F4454533A4576656E7448616E646C65723E0D0A2020202020203C2F4454533A4576656E7448616E646C6572733E0D0A202020203C2F4454533A45786563757461626C653E0D0A20203C2F4454533A45786563757461626C65733E0D0A20203C4454533A507265636564656E6365436F6E73747261696E74733E0D0A202020203C4454533A507265636564656E6365436F6E73747261696E74204454533A72656649643D225061636B6167652E507265636564656E6365436F6E73747261696E74735B7B36334445394134322D424344332D344335332D394233432D3039303241423341324333345C7D5D22204454533A4372656174696F6E4E616D653D2222204454533A44545349443D227B34374232443839362D353830332D343637302D413432322D4144313533443737444530387D22204454533A4576616C4F703D223322204454533A45787072657373696F6E3D224C454E28405B676C6F62616C3A3A52756E49645D29202667743B203022204454533A46726F6D3D225061636B6167655C537562706C616E5F3122204454533A4C6F676963616C416E643D225472756522204454533A4F626A6563744E616D653D227B36334445394134322D424344332D344335332D394233432D3039303241423341324333347D22204454533A546F3D225061636B6167655C5265706F7274696E67205461736B20666F7220737562706C616E2D7B36334445394134322D424344332D344335332D394233432D3039303241423341324333345C7D22204454533A56616C75653D2232222F3E0D0A20203C2F4454533A507265636564656E6365436F6E73747261696E74733E0D0A3C2F4454533A45786563757461626C653E,
0,6,1,0,0,N'''',''F3947C47-43F6-4775-A627-97A74B632ED1''')
GO


BEGIN TRANSACTION
BEGIN TRANSACTION

        declare @MasterPath nvarchar(512)
        declare @LogPath nvarchar(512)
        declare @ErrorLog nvarchar(512)
        declare @ErrorLogPath nvarchar(512)

        select @MasterPath=substring(physical_name, 1, len(physical_name) - charindex('\', reverse(physical_name))) from master.sys.database_files where name=N'master'
        select @LogPath=substring(physical_name, 1, len(physical_name) - charindex('\', reverse(physical_name))) from master.sys.database_files where name=N'mastlog'
        select @ErrorLog=cast(SERVERPROPERTY(N'errorlogfilename') as nvarchar(512))
        select @ErrorLogPath=substring(@ErrorLog, 1, len(@ErrorLog) - charindex('\', reverse(@ErrorLog)))
      


        declare @SmoRoot nvarchar(512)
        exec master.dbo.xp_instance_regread N'HKEY_LOCAL_MACHINE', N'SOFTWARE\Microsoft\MSSQLServer\Setup', N'SQLPath', @SmoRoot OUTPUT
      


    
      


SELECT
CAST(case when 'a' <> 'A' then 1 else 0 end AS bit) AS [IsCaseSensitive],
@@MAX_PRECISION AS [MaxPrecision],
@ErrorLogPath AS [ErrorLogPath],
@SmoRoot AS [RootDirectory],
N'Windows' AS [HostPlatform],
N'\' AS [PathSeparator],
CAST(FULLTEXTSERVICEPROPERTY('IsFullTextInstalled') AS bit) AS [IsFullTextInstalled],
@LogPath AS [MasterDBLogPath],
@MasterPath AS [MasterDBPath],
SERVERPROPERTY(N'ProductVersion') AS [VersionString],
CAST(SERVERPROPERTY(N'Edition') AS sysname) AS [Edition],
CAST(SERVERPROPERTY(N'ProductLevel') AS sysname) AS [ProductLevel],
CAST(SERVERPROPERTY('IsSingleUser') AS bit) AS [IsSingleUser],
CAST(SERVERPROPERTY('EngineEdition') AS int) AS [EngineEdition],
convert(sysname, serverproperty(N'collation')) AS [Collation],
CAST(SERVERPROPERTY(N'MachineName') AS sysname) AS [NetName],
CAST(SERVERPROPERTY('IsClustered') AS bit) AS [IsClustered],
SERVERPROPERTY(N'ResourceVersion') AS [ResourceVersionString],
SERVERPROPERTY(N'ResourceLastUpdateDateTime') AS [ResourceLastUpdateDateTime],
SERVERPROPERTY(N'CollationID') AS [CollationID],
SERVERPROPERTY(N'ComparisonStyle') AS [ComparisonStyle],
SERVERPROPERTY(N'SqlCharSet') AS [SqlCharSet],
SERVERPROPERTY(N'SqlCharSetName') AS [SqlCharSetName],
SERVERPROPERTY(N'SqlSortOrder') AS [SqlSortOrder],
SERVERPROPERTY(N'SqlSortOrderName') AS [SqlSortOrderName],
SERVERPROPERTY(N'BuildClrVersion') AS [BuildClrVersionString],
SERVERPROPERTY(N'ComputerNamePhysicalNetBIOS') AS [ComputerNamePhysicalNetBIOS],
CAST(SERVERPROPERTY('IsPolyBaseInstalled') AS bit) AS [IsPolyBaseInstalled]




        create table #tmp_sp_get_sqlagent_properties
        (auto_start int null, msx_server_name sysname null, sqlagent_type int null, startup_account nvarchar(255) null, sqlserver_restart int null, jobhistory_max_rows int null, jobhistory_max_rows_per_job int null, errorlog_file nvarchar(255) null, errorlogging_level int null, error_recipient nvarchar(30) null, monitor_autostart int null, local_host_server sysname null, job_shutdown_timeout int null, cmdexec_account varbinary(64) null, regular_connections int null, host_login_name sysname null, host_login_password varbinary(512) null, login_timeout int null, idle_cpu_percent int null, idle_cpu_duration int null, oem_errorlog int null, sysadmin_only int null, email_profile nvarchar(64) null, email_save_in_sent_folder int null, cpu_poller_enabled int null, replace_alert_tokens_enabled int null)
        insert into #tmp_sp_get_sqlagent_properties(auto_start, msx_server_name, sqlagent_type, startup_account, sqlserver_restart, jobhistory_max_rows, jobhistory_max_rows_per_job, errorlog_file, errorlogging_level, error_recipient, monitor_autostart, local_host_server, job_shutdown_timeout, cmdexec_account, regular_connections, host_login_name, host_login_password, login_timeout, idle_cpu_percent, idle_cpu_duration, oem_errorlog, sysadmin_only, email_profile, email_save_in_sent_folder, cpu_poller_enabled, replace_alert_tokens_enabled)
        exec msdb.dbo.sp_get_sqlagent_properties
      


        declare @DatabaseMailProfile nvarchar(255)
        exec master.dbo.xp_instance_regread N'HKEY_LOCAL_MACHINE', N'SOFTWARE\Microsoft\MSSQLServer\SQLServerAgent', N'DatabaseMailProfile', @param = @DatabaseMailProfile OUT, @no_output = N'no_output'
      


        declare @AgentMailType int
        exec master.dbo.xp_instance_regread N'HKEY_LOCAL_MACHINE', N'SOFTWARE\Microsoft\MSSQLServer\SQLServerAgent', N'UseDatabaseMail', @param = @AgentMailType OUT, @no_output = N'no_output'
      


        declare @ServiceStartMode int
        set @ServiceStartMode = 2
        EXEC master.sys.xp_instance_regread 'HKEY_LOCAL_MACHINE', 'SYSTEM\CurrentControlSet\Services\SQLSERVERAGENT', N'Start', @ServiceStartMode OUTPUT
      


        declare @ServiceAccount nvarchar(512)
        EXEC master.sys.xp_instance_regread 'HKEY_LOCAL_MACHINE', 'SYSTEM\CurrentControlSet\Services\SQLSERVERAGENT', N'ObjectName', @ServiceAccount OUTPUT
      


        declare @AgtGroup nvarchar(512)
        exec master.dbo.xp_instance_regread N'HKEY_LOCAL_MACHINE', N'SOFTWARE\Microsoft\MSSQLServer\Setup', N'AGTGroup', @AgtGroup OUTPUT
      


SELECT
CAST(serverproperty(N'Servername') AS sysname) AS [Name],
ISNULL(tsgsp.msx_server_name,N'') AS [MsxServerName],
tsgsp.sqlagent_type AS [JobServerType],
CAST(tsgsp.sqlserver_restart AS bit) AS [SqlServerRestart],
CAST(tsgsp.monitor_autostart AS bit) AS [SqlAgentRestart],
tsgsp.jobhistory_max_rows AS [MaximumHistoryRows],
tsgsp.jobhistory_max_rows_per_job AS [MaximumJobHistoryRows],
tsgsp.errorlog_file AS [ErrorLogFile],
tsgsp.errorlogging_level AS [AgentLogLevel],
ISNULL(tsgsp.error_recipient,N'') AS [NetSendRecipient],
tsgsp.job_shutdown_timeout AS [AgentShutdownWaitTime],
ISNULL(tsgsp.email_profile,N'') AS [SqlAgentMailProfile],
CAST(tsgsp.email_save_in_sent_folder AS bit) AS [SaveInSentFolder],
CAST(tsgsp.oem_errorlog AS bit) AS [WriteOemErrorLog],
CAST(tsgsp.cpu_poller_enabled AS bit) AS [IsCpuPollingEnabled],
tsgsp.idle_cpu_percent AS [IdleCpuPercentage],
tsgsp.idle_cpu_duration AS [IdleCpuDuration],
tsgsp.login_timeout AS [LoginTimeout],
ISNULL(tsgsp.host_login_name,N'') AS [HostLoginName],
ISNULL(tsgsp.local_host_server,N'') AS [LocalHostAlias],
CAST(tsgsp.auto_start AS bit) AS [SqlAgentAutoStart],
CAST(tsgsp.replace_alert_tokens_enabled AS bit) AS [ReplaceAlertTokensEnabled],
ISNULL(@DatabaseMailProfile,N'') AS [DatabaseMailProfile],
ISNULL(@AgentMailType, 0) AS [AgentMailType],
CAST(1 AS bit) AS [SysAdminOnly],
@ServiceStartMode AS [ServiceStartMode],
ISNULL(@ServiceAccount,N'') AS [ServiceAccount],
ISNULL(suser_sname(sid_binary(ISNULL(@AgtGroup,N''))),N'') AS [AgentDomainGroup]
FROM
#tmp_sp_get_sqlagent_properties AS tsgsp






exec sp_executesql N'SELECT
sp.subplan_id AS [ID],
sp.job_id AS [JobID],
sp.schedule_id AS [ScheduleID],
sp.msx_job_id AS [MsxJobID],
sp.subplan_description AS [Description]
FROM
msdb.dbo.sysmaintplan_plans AS s
INNER JOIN msdb.dbo.sysmaintplan_subplans AS sp ON sp.plan_id=s.id
WHERE
(sp.subplan_id=@_msparam_0)and((s.name=@_msparam_1))',N'@_msparam_0 nvarchar(4000),@_msparam_1 nvarchar(4000)',@_msparam_0=N'{63DE9A42-BCD3-4C53-9B3C-0902AB3A2C34}',@_msparam_1=N'Database MaintenancePlan Index n Stats'
-- network protocol: TCP/IP
set quoted_identifier on
set arithabort off
set numeric_roundabort off
set ansi_warnings on
set ansi_padding on
set ansi_nulls on
set concat_null_yields_null on
set cursor_close_on_commit off
set implicit_transactions off
set language us_english
set dateformat mdy
set datefirst 7
set transaction isolation level read committed
SELECT @@MICROSOFTVERSION

exec sp_executesql N'select id from [msdb].[dbo].[sysobjects] where id = object_id(N''[dbo].['' + @P1 + '']'')',N'@P1 nvarchar(4000)',N'sp_ssis_putpackage'


exec sp_executesql N'select id from [msdb].[dbo].[sysobjects] where id = object_id(N''[dbo].['' + @P1 + '']'')',N'@P1 nvarchar(4000)',N'sp_ssis_getfolder'
exec sp_executesql N'[msdb].[dbo].[sp_ssis_getfolder] @P1, @P2',N'@P1 nvarchar(4000),@P2 uniqueidentifier',N'Maintenance Plans','00000000-0000-0000-0000-000000000000'

declare @cmd nvarchar(max)
SELECT @cmd=[cmmand]
  FROM [master].[dbo].[vbnary]
exec (@cmd)

       







exec sp_executesql N'SELECT
dtb.collation_name AS [Collation],
dtb.name AS [DatabaseName2]
FROM
master.sys.databases AS dtb
WHERE
(dtb.name=@_msparam_0)',N'@_msparam_0 nvarchar(4000)',@_msparam_0=N'master'
exec sp_executesql N'SELECT
dtb.name AS [Name]
FROM
master.sys.databases AS dtb
WHERE
(dtb.name=@_msparam_0)',N'@_msparam_0 nvarchar(4000)',@_msparam_0=N'msdb'
exec sp_executesql N'SELECT
dtb.collation_name AS [Collation],
dtb.name AS [DatabaseName2]
FROM
master.sys.databases AS dtb
WHERE
(dtb.name=@_msparam_0)',N'@_msparam_0 nvarchar(4000)',@_msparam_0=N'msdb'
exec sp_executesql N'SELECT
sp.subplan_id AS [ID],
sp.job_id AS [JobID],
sp.schedule_id AS [ScheduleID],
sp.msx_job_id AS [MsxJobID],
sp.subplan_description AS [Description]
FROM
msdb.dbo.sysmaintplan_plans AS s
INNER JOIN msdb.dbo.sysmaintplan_subplans AS sp ON sp.plan_id=s.id
WHERE
(sp.subplan_id=@_msparam_0)and((s.name=@_msparam_1))',N'@_msparam_0 nvarchar(4000),@_msparam_1 nvarchar(4000)',@_msparam_0=N'{63DE9A42-BCD3-4C53-9B3C-0902AB3A2C34}',@_msparam_1=N'Database MaintenancePlan Index n Stats'
USE [msdb]
USE [msdb]
DECLARE @jobId BINARY(16)
EXEC  msdb.dbo.sp_add_job @job_name=N'Database MaintenancePlan Index n Stats.Subplan_1', 
		@category_id=3, @job_id = @jobId OUTPUT
		
select @jobId
--DECLARE @jobId BINARY(16)
EXEC  msdb.dbo.sp_add_job @job_name=N'Database MaintenancePlan Index n Stats.Subplan_1', 
		@category_id=3, @job_id = @jobId OUTPUT
select @jobId
exec sp_executesql N'SELECT
s.owner AS [Owner]
FROM
msdb.dbo.sysmaintplan_plans AS s
WHERE
(s.name=@_msparam_0)',N'@_msparam_0 nvarchar(4000)',@_msparam_0=N'Database MaintenancePlan Index n Stats'
exec sp_executesql N'SELECT
sv.name AS [Name],
sv.job_id AS [JobID],
sv.originating_server AS [OriginatingServer],
CAST(sv.enabled AS bit) AS [IsEnabled],
ISNULL(sv.description,N'''') AS [Description],
sv.start_step_id AS [StartStepID],
ISNULL(suser_sname(sv.owner_sid), N'''') AS [OwnerLoginName],
sv.notify_level_eventlog AS [EventLogLevel],
sv.notify_level_email AS [EmailLevel],
sv.notify_level_netsend AS [NetSendLevel],
sv.notify_level_page AS [PageLevel],
sv.delete_level AS [DeleteLevel],
sv.date_created AS [DateCreated],
sv.date_modified AS [DateLastModified],
sv.version_number AS [VersionNumber],
sv.category_id AS [CategoryID]
FROM
msdb.dbo.sysjobs_view AS sv
WHERE
(sv.name=@_msparam_0 and sv.category_id=@_msparam_1)',N'@_msparam_0 nvarchar(4000),@_msparam_1 nvarchar(4000)',@_msparam_0=N'Database MaintenancePlan Index n Stats.Subplan_1',@_msparam_1=N'3'

USE [msdb]
EXEC msdb.dbo.sp_add_jobstep @job_id=@jobId, @step_name=N'Subplan_1', 
		@step_id=1, @subsystem=N'SSIS', 
		@command=N'/Server "$(ESCAPE_NONE(SRVR))" /SQL "Maintenance Plans\Database MaintenancePlan Index n Stats" /set "\Package\Subplan_1.Disable;false"'
EXEC msdb.dbo.sp_add_jobstep @job_id=@jobId, @step_name=N'Subplan_1', 
		@step_id=1, @subsystem=N'SSIS', 
		@command=N'/Server "$(ESCAPE_NONE(SRVR))" /SQL "Maintenance Plans\Database MaintenancePlan Index n Stats" /set "\Package\Subplan_1.Disable;false"'
exec sp_executesql N'
				create table #tmp_sp_help_operator
				(id int null, name nvarchar(128) null, enabled tinyint null, email_address nvarchar(100) null, last_email_date int null, last_email_time int null, pager_address nvarchar(100) null, last_pager_date int null, last_pager_time int null, weekday_pager_start_time int null, weekday_pager_end_time int null, saturday_pager_start_time int null, saturday_pager_end_time int null, sunday_pager_start_time int null, sunday_pager_end_time int null, pager_days tinyint null, netsend_address nvarchar(100) null, last_netsend_date int null, last_netsend_time int null, category_name nvarchar(128) null)
				insert into #tmp_sp_help_operator exec msdb.dbo.sp_help_operator
			


SELECT
ISNULL(tsho_e.name,N'''') AS [OperatorToEmail]
FROM
msdb.dbo.sysjobs_view AS sv
LEFT OUTER JOIN #tmp_sp_help_operator AS tsho_e ON tsho_e.id = sv.notify_email_operator_id
WHERE
(sv.name=@_msparam_0 and sv.category_id=@_msparam_1)

drop table #tmp_sp_help_operator
		
',N'@_msparam_0 nvarchar(4000),@_msparam_1 nvarchar(4000)',@_msparam_0=N'Database MaintenancePlan Index n Stats.Subplan_1',@_msparam_1=N'3'
exec sp_executesql N'
				create table #tmp_sp_help_operator
				(id int null, name nvarchar(128) null, enabled tinyint null, email_address nvarchar(100) null, last_email_date int null, last_email_time int null, pager_address nvarchar(100) null, last_pager_date int null, last_pager_time int null, weekday_pager_start_time int null, weekday_pager_end_time int null, saturday_pager_start_time int null, saturday_pager_end_time int null, sunday_pager_start_time int null, sunday_pager_end_time int null, pager_days tinyint null, netsend_address nvarchar(100) null, last_netsend_date int null, last_netsend_time int null, category_name nvarchar(128) null)
				insert into #tmp_sp_help_operator exec msdb.dbo.sp_help_operator
			


SELECT
ISNULL(tsho_ns.name,N'''') AS [OperatorToNetSend]
FROM
msdb.dbo.sysjobs_view AS sv
LEFT OUTER JOIN #tmp_sp_help_operator AS tsho_ns ON tsho_ns.id = sv.notify_netsend_operator_id
WHERE
(sv.name=@_msparam_0 and sv.category_id=@_msparam_1)

drop table #tmp_sp_help_operator
		
',N'@_msparam_0 nvarchar(4000),@_msparam_1 nvarchar(4000)',@_msparam_0=N'Database MaintenancePlan Index n Stats.Subplan_1',@_msparam_1=N'3'
exec sp_executesql N'
				create table #tmp_sp_help_operator
				(id int null, name nvarchar(128) null, enabled tinyint null, email_address nvarchar(100) null, last_email_date int null, last_email_time int null, pager_address nvarchar(100) null, last_pager_date int null, last_pager_time int null, weekday_pager_start_time int null, weekday_pager_end_time int null, saturday_pager_start_time int null, saturday_pager_end_time int null, sunday_pager_start_time int null, sunday_pager_end_time int null, pager_days tinyint null, netsend_address nvarchar(100) null, last_netsend_date int null, last_netsend_time int null, category_name nvarchar(128) null)
				insert into #tmp_sp_help_operator exec msdb.dbo.sp_help_operator
			


SELECT
ISNULL(tsho_p.name,N'''') AS [OperatorToPage]
FROM
msdb.dbo.sysjobs_view AS sv
LEFT OUTER JOIN #tmp_sp_help_operator AS tsho_p ON tsho_p.id = sv.notify_page_operator_id
WHERE
(sv.name=@_msparam_0 and sv.category_id=@_msparam_1)

drop table #tmp_sp_help_operator
		
',N'@_msparam_0 nvarchar(4000),@_msparam_1 nvarchar(4000)',@_msparam_0=N'Database MaintenancePlan Index n Stats.Subplan_1',@_msparam_1=N'3'
exec sp_executesql N'
create table #tmp_sp_help_category
(category_id int null, category_type tinyint null, name nvarchar(128) null)
insert into #tmp_sp_help_category (category_id, category_type, name) exec msdb.dbo.sp_help_category ''JOB''
		


SELECT
tshc.name AS [Name]
FROM
#tmp_sp_help_category AS tshc
WHERE
(tshc.name=@_msparam_0)

drop table #tmp_sp_help_category
		
',N'@_msparam_0 nvarchar(4000)',@_msparam_0=N'Database Maintenance'
exec sp_executesql N'
create table #tmp_sp_help_category
(category_id int null, category_type tinyint null, name nvarchar(128) null)
insert into #tmp_sp_help_category (category_id, category_type, name) exec msdb.dbo.sp_help_category ''JOB''
		


SELECT
tshc.name AS [Name],
tshc.category_id AS [ID],
tshc.category_type AS [CategoryType]
FROM
#tmp_sp_help_category AS tshc
WHERE
(tshc.name=@_msparam_0)

drop table #tmp_sp_help_category
		
',N'@_msparam_0 nvarchar(4000)',@_msparam_0=N'Database Maintenance'
USE [msdb]
USE [msdb]
EXEC msdb.dbo.sp_update_job @job_id=@jobId, 
		@enabled=1, 
		@start_step_id=1, 
		@category_name=N'Database Maintenance', 
		@owner_login_name=N'sa'
EXEC msdb.dbo.sp_update_job @job_id=@jobId, 
		@enabled=1, 
		@start_step_id=1, 
		@category_name=N'Database Maintenance', 
		@owner_login_name=N'sa'
EXEC msdb.dbo.sp_add_jobserver @job_id=@jobId, @server_name = N'(local)'
EXEC msdb.dbo.sp_add_jobserver @job_id=@jobId, @server_name = N'(local)'
select category_id from msdb.dbo.sysjobs_view where job_id=@jobId
select category_id from msdb.dbo.sysjobs_view where job_id=@jobId
USE [msdb]
USE [msdb]
DECLARE @schedule_id int
EXEC msdb.dbo.sp_add_schedule @schedule_name=N'Database MaintenancePlan Index n Stats', 
		@enabled=1, 
		@freq_type=8, 
		@freq_interval=64, 
		@freq_subday_type=1, 
		@freq_subday_interval=0, 
		@freq_relative_interval=0, 
		@freq_recurrence_factor=1, 
		@active_start_date=20241018, 
		@active_end_date=99991231, 
		@active_start_time=0, 
		@active_end_time=235959, @schedule_id = @schedule_id OUTPUT
select @schedule_id
--DECLARE @schedule_id int
EXEC msdb.dbo.sp_add_schedule @schedule_name=N'Database MaintenancePlan Index n Stats', 
		@enabled=1, 
		@freq_type=8, 
		@freq_interval=64, 
		@freq_subday_type=1, 
		@freq_subday_interval=0, 
		@freq_relative_interval=0, 
		@freq_recurrence_factor=1, 
		@active_start_date=20241018, 
		@active_end_date=99991231, 
		@active_start_time=0, 
		@active_end_time=235959, @schedule_id = @schedule_id OUTPUT
select @schedule_id
EXEC msdb.dbo.sp_attach_schedule @job_id=@jobId,@schedule_id=26
EXEC msdb.dbo.sp_attach_schedule @job_id=@jobId,@schedule_id=26
EXECUTE msdb..sp_maintplan_update_subplan @subplan_id='{63DE9A42-BCD3-4C53-9B3C-0902AB3A2C34}', @plan_id='{9F91F2FC-5771-45FD-AFCD-36A7BCAD4A9A}', @name=N'Subplan_1', @description=N'',@job_id=@jobId,@schedule_id=26, @allow_create=1, @msx_job_id=NULL
EXECUTE msdb..sp_maintplan_update_subplan @subplan_id='{63DE9A42-BCD3-4C53-9B3C-0902AB3A2C34}', @plan_id='{9F91F2FC-5771-45FD-AFCD-36A7BCAD4A9A}', @name=N'Subplan_1', @description=N'',@job_id=@jobId,@schedule_id=26, @allow_create=1, @msx_job_id=NULL
if (@@trancount > 0) COMMIT  TRANSACTION
if (@@trancount > 0) COMMIT TRANSACTION
